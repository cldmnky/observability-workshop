# Tempo Operator Configuration
operator:
  # Namespace where the Tempo operator will be installed
  namespace: openshift-tempo-operator
  # Operator channel (stable, tech-preview)
  channel: stable
  # Install plan approval (Automatic or Manual)
  installPlanApproval: Automatic
  # Source catalog
  source: redhat-operators
  # Source namespace
  sourceNamespace: openshift-marketplace

# S3 Storage Configuration
storage:
  # Storage backend type: odf or external
  # - odf: Use OpenShift Data Foundation (ODF) with ObjectBucketClaim
  # - external: Use external S3 (MinIO, AWS S3, etc.)
  type: odf
  # TLS settings for object storage
  tls:
    # Disable TLS for ODF NooBaa HTTP endpoint (port 80)
    enabled: false
  
  # ODF storage configuration (type: odf)
  odf:
    # Enable ObjectBucketClaim creation
    enabled: true
    # Bucket name (ObjectBucketClaim name)
    bucketName: tempo-bucket
    # StorageClass for OBC (NooBaa MCG)
    storageClassName: openshift-storage.noobaa.io
    # Delete bucket when chart is uninstalled
    reclaimPolicy: Delete
    # Auto-sync OBC credentials into the tempo-storage secret expected by the operator
    secretSync:
      # Enable Job that creates/updates tempo-storage from OBC Secret/ConfigMap
      enabled: true
      # Container image used to run oc commands
      image: registry.redhat.io/openshift4/ose-cli:latest
      # Polling interval while waiting for OBC Secret/ConfigMap
      pollIntervalSeconds: 5
      # Maximum number of polling attempts before failing
      maxAttempts: 120
      # Use HTTPS endpoint from OBC data (NooBaa HTTP port 80 avoids TLS trust issues)
      useHttpsEndpoint: false

  # External S3 storage configuration (type: external)
  external:
    # Secret name for S3 credentials
    secretName: tempostack-dev-minio
    # S3 endpoint (without https://)
    endpoint: storage.blahonga.me:9199
    # S3 bucket name
    bucket: borg-tempo
    # S3 access key ID - MUST BE PROVIDED when type=external
    accessKeyId: ""
    # S3 secret access key - MUST BE PROVIDED when type=external
    accessKeySecret: ""

# TempoStack Configuration
tempoStack:
  # Name of the TempoStack CR
  name: tempo
  # Namespace (same as operator namespace)
  namespace: openshift-tempo-operator
  
  # Stack size (1x.extra-small, 1x.small, 1x.medium, 1x.large)
  size: 1x.small
  
  # Storage configuration
  storageSize: 1Gi
  
  # Retention configuration
  retention:
    # Global trace retention period
    global: 48h0m0s
  
  # Replication factor (1 for dev/demo, 3 for production)
  replicationFactor: 1
  
  # Resource limits
  resources:
    total:
      limits:
        cpu: 2
        memory: 2Gi
  
  # Ingestion limits
  limits:
    global:
      ingestion:
        # Burst size in bytes
        ingestionBurstSizeBytes: 20000000
        # Rate limit in bytes/second
        ingestionRateLimitBytes: 15000000
      query:
        # Max search duration (0s = no limit)
        maxSearchDuration: 0s
  
  # Gateway configuration for authentication and multi-tenancy
  gateway:
    enabled: true
    # Ingress type (route for OpenShift)
    ingressType: route
  
  # Jaeger UI configuration
  jaegerUI:
    enabled: true

# Multi-tenancy Configuration
tenants:
  # Dev tenant configuration
  dev:
    # Tenant ID (UUID) - used in X-Scope-OrgID header
    id: 1610b0c3-c509-4592-a256-a1871353dbfa
    # Authentication mode (static for pre-defined tenants)
    authentication:
      type: static
  # Prod tenant configuration
  prod:
    # Tenant ID (UUID) - used in X-Scope-OrgID header
    id: 6094b0f1-711d-4395-82c0-30c2720c6648
    authentication:
      type: static

# RBAC Configuration
rbac:
  # Enable RBAC for trace access
  enabled: true
  # ClusterRole name
  clusterRoleName: tempostack-traces-reader
