{{- if and .Values.lokiStack.enabled (eq .Values.lokiStack.s3.type "external") }}
apiVersion: v1
kind: Secret
metadata:
  name: {{ default (printf "%s-s3" .Values.lokiStack.name) .Values.lokiStack.s3.secretName }}
  namespace: {{ .Values.lokiStack.namespace }}
  annotations:
    argocd.argoproj.io/sync-wave: "2"
type: Opaque
stringData:
  endpoint: {{ .Values.lokiStack.s3.external.endpoint }}
  region: {{ .Values.lokiStack.s3.external.region }}
  bucketnames: {{ .Values.lokiStack.s3.external.bucketnames }}
  access_key_id: {{ .Values.lokiStack.s3.external.accessKeyId }}
  access_key_secret: {{ .Values.lokiStack.s3.external.accessKeySecret }}
{{- end }}
